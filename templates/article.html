{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Standard Meta -->
    <meta charset="utf-8"/>
    <meta name="referrer" content="never">  <!--解决禁止外链-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    <title>newsQQ</title>
    <link rel="stylesheet" href="{% static 'css/semantic.min.css' %}">
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/semantic.min.js' %}"></script>

    <style type="text/css">
        .hidden.menu {
            display: none;
        }

        .fadeout h2 {
            font-size: 1.7em;
            font-weight: normal;
        }

        .ui.vertical.stripe h3 {
            font-size: 2em;
        }

        .ui.vertical.stripe .button + h3,
        .ui.vertical.stripe p + h3 {
            margin-top: 3em;
        }

        .secondary.pointing.menu .toc.item {
            display: none;
        }

        @media only screen and (max-width: 700px) {
            .ui.fixed.menu {
                display: none !important;
            }

            .secondary.pointing.menu .item,
            .secondary.pointing.menu .menu {
                display: none;
            }

            .secondary.pointing.menu .toc.item {
                display: block;
            }
        }
    </style>

</head>

<body>
<!--下滑后的顶部栏-->
<div class="ui large top fixed hidden menu">
    <div class="ui container" style="font-size: 18px">
        {% for i in cate_type %}
            <a class="item" href="{{ i.type_link }}">{{ i.type_name }}</a>
        {% endfor %}
    </div>
</div>
<!--侧边栏-->
<div class="ui vertical inverted sidebar menu">
    {% for i in cate_type %}
        <a class="item" href="{{ i.type_link }}">{{ i.type_name }}</a>
    {% endfor %}
</div>

<!--以下为网站内容-->
<div class="pusher">
    <!--顶部菜单栏-->
    <div class="ui vertical center aligned segment fadeout" style="background-color: #2B313C">
        <div class="ui container">
            <div class="ui secondary inverted pointing menu" style="border-width: 0; font-size: 18px">
                <a class="toc item">
                    <i class="sidebar icon"></i>
                </a>
                {% for i in cate_type %}
                    <a class="item" href="{{ i.type_link }}">{{ i.type_name }}</a>
                {% endfor %}
            </div>
        </div>
    </div>
    {#文章列表部分#}
    <div class="ui equal width grid">
        <div class="row">
            <div class="ui container segment">
                <div class="ui divided items">
                    {% for item in article %}
                        <div class="item">
                            <div class="image">
                                <img src="{{ item.image }}">
                            </div>
                            <div class="content">
                                <div>
                                    <a class="ui header" href="{{ item.href }}" target="_blank">{{ item.title }}</a>
                                </div>
                                <div class="description">
                                    <span style="color: rgba(0,132,255,0.76)">{{ item.category }}</span>
                                    <a href="{{ item.href }}"
                                       target="_blank">&nbsp;&nbsp;&nbsp;&nbsp;{{ item.source }}</a>
                                    <span>&nbsp;&nbsp;&nbsp;&nbsp;{{ item.time }}</span>
                                    <p>{{ item.introduce|linebreaks }}</p>
                                </div>
                                <div class="extra">
                                    {% for i in item.keywords %}
                                        <div class="ui label">
                                            {{ i }}
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <div class="ui pagination menu">
                    {% if article.has_previous %}
                        <span class="item" id="pre_page">< pre</span>
                    {% endif %}
                    <div class="disable item">
                        page {{ article.number }} of {{ article.paginator.num_pages }}
                    </div>
                    {% if article.has_next %}
                        <span class="item" id="next_page"> next ></span>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    $(document)
        .ready(function () {
            // fix menu when passed
            $('.fadeout')
                .visibility({
                    once: false,
                    onBottomPassed: function () {
                        $('.fixed.menu').transition('fade in');
                    },
                    onBottomPassedReverse: function () {
                        $('.fixed.menu').transition('fade out');
                    }
                });
            // create sidebar and attach to menu open
            $('.ui.sidebar')
                .sidebar('attach events', '.toc.item');
        });

    $('#pre_page').click(function () {
        var url = window.location.search;
        var cate = url.split('?')[1].split('=')[1].split('&')[0];
        {% if article.has_previous %}
            window.location.href = "http://127.0.0.1:8000/article/" + "?cate=" + cate + "&page={{ article.previous_page_number }}";
        {% endif %}
    });

    $('#next_page').click(function () {
        var url = window.location.search;
        var cate = 'politics';
        if (url.indexOf("?") != -1)
            cate = url.split('?')[1].split('=')[1].split('&')[0];
        {% if article.has_next %}
            window.location.href = "http://127.0.0.1:8000/article/" + "?cate=" + cate + "&page={{ article.next_page_number }}";
        {% endif %}
    });
</script>
</body>
</html>
